YT Tutorial:
https://youtu.be/eLXjxk4eA_M

Sure! Below is a GitHub-friendly description for your **README.md** file, explaining how both the PowerShell and Python scripts work together, and how users can utilize them in their project:

---

# Abnormal File Scanner with VirusTotal Integration

This project provides a two-part solution for scanning files in a specified directory for abnormal file extensions, calculating their SHA256 hashes, and then analyzing those hashes with the **VirusTotal API**. The results are exported to an Excel file for easy review.

## Features

### 1. **PowerShell Script**:
- Scans all files in a specified directory.
- Identifies files with abnormal extensions (extensions not part of a pre-defined list).
- Calculates the SHA256 hash of abnormal files.
- Exports the abnormal file details (extension, file path, and hash) to an Excel report.
- Invokes a Python script to analyze the hashes using the VirusTotal API.

### 2. **Python Script**:
- Reads the Excel file generated by the PowerShell script.
- Uses the **VirusTotal API** to scan each file hash.
- Updates the Excel report with the VirusTotal scan results (positives/total number of scans).

---

## How to Use

### Step 1: Clone the Repository
First, clone the repository to your local machine:
```bash
git clone https://github.com/yourusername/abnormal-file-scanner.git
cd abnormal-file-scanner
```

### Step 2: PowerShell Script
1. Open the `AbnormalFileScanner.ps1` PowerShell script.
2. Update the following variables:
   - **`$scanDirectory`**: Set the directory to scan for abnormal files.
   - **`$outputExcelPath`**: Specify the location where the Excel report should be saved.
   - **`$normalExtensions`**: Customize the list of "normal" file extensions (e.g., `".txt"`, `".jpg"`).
   - **`$scriptPath`**: Specify the path to the Python script that will be invoked.

3. Run the PowerShell script:
   ```powershell
   .\AbnormalFileScanner.ps1
   ```
   This script will:
   - Recursively scan all files in the specified directory.
   - Identify files with extensions not in the `normalExtensions` list.
   - Generate an Excel report containing the file paths and their SHA256 hashes.
   - Automatically run the Python script to analyze the file hashes using the VirusTotal API.

### Step 3: Python Script
1. Open the `Script.py` Python file.
2. Replace the placeholder **VirusTotal API key** with your actual API key in the `scan_file_hash` function.
   ```python
   api_key = "your_virustotal_api_key"
   ```

3. The Python script is invoked automatically by the PowerShell script after the Excel file is generated. Alternatively, you can run the Python script manually:
   ```bash
   python Script.py
   ```
   This script will:
   - Read the Excel file generated by the PowerShell script.
   - For each file hash, query the VirusTotal API.
   - Update the Excel sheet with the VirusTotal results (number of positives and total scans).

---

## File Structure

```
abnormal-file-scanner/
├── AbnormalFileScanner.ps1     # PowerShell script to scan files and generate an Excel report
├── Script.py                   # Python script to analyze file hashes using VirusTotal API
├── README.md                   # Project documentation
└── requirements.txt            # Python dependencies (e.g., requests, openpyxl, pandas)
```

---

## Prerequisites

### PowerShell Script:
- **Windows PowerShell** with the `ImportExcel` module installed. Install it by running:
  ```powershell
  Install-Module -Name ImportExcel
  ```

### Python Script:
- **Python 3.x** with the following packages:
  - `openpyxl`
  - `requests`
  - `pandas`

Install the required packages using `pip`:
```bash
pip install -r requirements.txt
```

---

## Example Workflow

1. The **PowerShell script** scans files in the directory you specify, identifies files with abnormal extensions, and calculates their hashes.
2. It then exports this data to an Excel file.
3. The **Python script** takes over and sends the file hashes to VirusTotal for scanning.
4. The results are added to the same Excel report, showing the number of antivirus engines that flagged the file as malicious.
